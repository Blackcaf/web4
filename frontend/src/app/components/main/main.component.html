<div class="main-container">

    <header class="floating-header">
        <div class="logo">
            <span>Area Check</span>
        </div>

        <div class="controls-area">
            <button class="btn-theme-toggle" (click)="toggleTheme()" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
                {{ isDarkTheme ? 'üåô' : '‚òÄÔ∏è' }}
            </button>

            <div class="user-badge">
                <span>üë§</span>
                <span>{{ username }}</span>
            </div>

            <button class="btn-logout" (click)="logout()">
                –í—ã–π—Ç–∏
            </button>
        </div>
    </header>

    <nav class="side-nav">
        <a (click)="scrollTo('intro')" class="nav-dot" title="–ò–Ω—Ñ–æ"></a>
        <a (click)="scrollTo('workspace')" class="nav-dot" title="–ì—Ä–∞—Ñ–∏–∫"></a>
        <a (click)="scrollTo('data')" class="nav-dot" title="–¢–∞–±–ª–∏—Ü–∞"></a>
    </nav>

    <section id="intro" class="screen intro-screen">
        <div class="intro-card">
            <div class="intro-badge">Web Programming</div>
            <h1>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ4</h1>

            <div class="info-grid">
                <div class="info-item">
                    <span class="label">–°—Ç—É–¥–µ–Ω—Ç</span>
                    <span class="value">–ú–∞–Ω—Ç—É—à –î–∞–Ω–∏–∏–ª –í–∞–ª–µ—Ä—å–µ–≤–∏—á</span>
                </div>
                <div class="info-item">
                    <span class="label">–ì—Ä—É–ø–ø–∞</span>
                    <span class="value">P3219</span>
                </div>
                <div class="info-item">
                    <span class="label">–í–∞—Ä–∏–∞–Ω—Ç</span>
                    <span class="value accent">4758</span>
                </div>
            </div>

            <button class="btn-start" (click)="scrollTo('workspace')">
                –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É
            </button>
        </div>

        <div class="scroll-indicator" (click)="scrollTo('workspace')">
            <span>–õ–∏—Å—Ç–∞–π –≤–Ω–∏–∑</span>
            <div class="arrow">‚Üì</div>
        </div>
    </section>

    <section id="workspace" class="screen workspace-screen">
        <div class="content-wrapper">

            <div class="input-section card">
                <h2>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã</h2>

                <div class="form-group">
                    <label for="x">X (-5 ... 3)</label>
                    <input
                            type="text"
                            id="x"
                            [(ngModel)]="xInput"
                            (input)="onXChange($event)"
                            placeholder="–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ"
                            autocomplete="off"
                            [class.input-error-border]="isXInvalid"
                    >
                    <div class="input-warning" *ngIf="isXInvalid">–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ!</div>
                </div>

                <div class="form-group">
                    <label for="y">Y (-3 ... 5)</label>
                    <input
                            type="text"
                            id="y"
                            [(ngModel)]="yInput"
                            (input)="onYChange($event)"
                            placeholder="–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ"
                            autocomplete="off"
                            [class.input-error-border]="isYInvalid"
                    >
                    <div class="input-warning" *ngIf="isYInvalid">–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ!</div>
                </div>

                <div class="form-group">
                    <label for="r">R (-5 ... 3)</label>
                    <input
                            type="text"
                            id="r"
                            [(ngModel)]="rInput"
                            (input)="onRChange($event)"
                            placeholder="–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ"
                            autocomplete="off"
                            [class.input-error-border]="isRInvalid"
                    >
                    <div class="input-warning" *ngIf="isRInvalid">–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ!</div>
                    <div class="input-warning" *ngIf="isRNegative && !isRInvalid">–†–∞–¥–∏—É—Å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º!</div>
                </div>

                <div class="error-message" *ngIf="errorMessage">{{ errorMessage }}</div>

                <div class="button-group">
                    <button class="btn-primary" (click)="checkPoint()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                    <button class="btn-secondary" (click)="clearResults()">üóëÔ∏è</button>
                </div>
            </div>

            <div class="canvas-section card">
                <h2>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</h2>
                <div class="canvas-container">
                    <canvas
                        #canvas
                        width="600"
                        height="600"
                        style="width: 300px; height: 300px;"
                        (click)="onCanvasClick()"
                        (mousemove)="onCanvasMouseMove($event)"
                        (mouseleave)="onCanvasMouseLeave()"
                    ></canvas>
                    <p class="hint" *ngIf="!isRNegative && currentR">
                        –ö—É—Ä—Å–æ—Ä –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ–ø—É—Å—Ç–∏–º–æ–π –æ–±–ª–∞—Å—Ç—å—é
                    </p>
                </div>
            </div>

        </div>
    </section>

    <section id="data" class="screen data-screen">
        <div class="table-card card">
            <div class="table-header">
                <h2>–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫ <span class="count-badge">{{ results.length }} –∑–∞–ø–∏—Å–µ–π</span></h2>
            </div>

            <div class="table-container">
                <table>
                    <thead>
                    <tr>
                        <th>X</th>
                        <th>Y</th>
                        <th>R</th>
                        <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
                        <th>–í—Ä–µ–º—è</th>
                        <th>–°–∫—Ä–∏–ø—Ç</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr *ngFor="let result of results">
                        <td>{{ result.x }}</td>
                        <td>{{ result.y }}</td>
                        <td>{{ result.r }}</td>
                        <td>
                <span class="badge" [class.badge-hit]="result.hit" [class.badge-miss]="!result.hit">
                  {{ result.hit ? '–ü–æ–ø–∞–¥–∞–Ω–∏–µ' : '–ü—Ä–æ–º–∞—Ö' }}
                </span>
                        </td>
                        <td>{{ result.timestamp | date:'HH:mm:ss' }}</td>
                        <td>{{ result.executionTime }} –º–∫—Å</td>
                    </tr>
                    <tr *ngIf="results.length === 0">
                        <td colspan="6" class="empty-state">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <div class="modal-overlay" *ngIf="showMathModal" (click)="closeMathModal()">
        <div class="modal-content" (click)="$event.stopPropagation()">
            <span class="modal-icon">üìê</span>
            <h3 class="modal-title">–û—à–∏–±–∫–∞ –≤–≤–æ–¥–∞</h3>
            <p class="modal-text">–í—ã –º–∞—Ç–µ–º–∞—Ç–∏–∫—É –≤ —à–∫–æ–ª–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏? <br>–†–∞–¥–∏—É—Å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º.</p>
            <button class="btn-modal" (click)="closeMathModal()">–ü—Ä–æ—Ö–æ–¥–∏–ª</button>
        </div>
    </div>

</div>